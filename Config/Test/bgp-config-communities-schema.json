{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "BGP Configuration",
    "type": "object",
    "properties": {
        "router-id": {
            "type": "string",
            "format": "ipv4",
            "description": "The BGP router ID"
        },
        "local-asn": {
            "type": "integer",
            "minimum": 1,
            "maximum": 4294967295,
            "description": "Local AS number"
        },
        "sessions": {
            "type": "object",
            "description": "BGP sessions keyed by session name (max 128 chars, letters, digits, dash, underscore)",
            "patternProperties": {
                "^[a-zA-Z0-9_-]{1,128}$": {
                    "type": "object",
                    "properties": {
                        "peer-address": {
                            "type": "string",
                            "description": "IPv4 or IPv6 address of the BGP peer",
                            "oneOf": [
                                { "format": "ipv4" },
                                { "format": "ipv6" }
                            ]
                        },
                        "remote-asn": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 4294967295,
                            "description": "Remote AS number"
                        },
                        "address-family": {
                            "type": "array",
                            "description": "List of supported address families",
                            "items": {
                                "type": "string",
                                "enum": [
                                    "ipv4-unicast",
                                    "ipv6-unicast",
                                    "vpnv4-unicast",
                                    "vpnv6-unicast",
                                    "evpn"
                                ]
                            },
                            "minItems": 1,
                            "uniqueItems": true
                        },
                        "standard-community": {
                            "$ref": "#/$defs/standard-community"
                        },
                        "extended-community": {
                            "$ref": "#/$defs/extended-community"
                        },
                        "large-community": {
                            "$ref": "#/$defs/large-community"
                        }
                    },
                    "required": ["peer-address", "remote-asn", "address-family"],
                    "additionalProperties": false
                }
            },
            "additionalProperties": false
        }
    },
    "required": ["router-id", "local-asn", "sessions"],
    "additionalProperties": false
}
