{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "bgp-main-config",
  "type": "object",
  "$defs": {
    "addr-family-type": {
      "type": "string",
      "enum": [ "ipv4", "ipv6" ]
    },
    "community-body-select": {
      "oneOf": [
        {
          "$ref": "#/$defs/community-set-type"
        },
        {
          "type": "object",
          "properties": {
            "community-list": {
              "$ref": "#/$defs/list-name-type"
            }
          },
          "required": ["community-list"],
          "additionalProperties": false
        }
      ]
    },
    "ext-community-body-select": {
      "oneOf": [
        {
          "$ref": "#/$defs/ext-community-set-type"
        },
        {
          "type": "object",
          "properties": {
            "ext-community-list": {
              "$ref": "#/$defs/list-name-type"
            }
          },
          "required": ["ext-community-list"],
          "additionalProperties": false
        }
      ]
    },
    "if-match-body": {
      "type": "object",
      "properties": {
        "as-path-eq": {
          "$ref": "#/$defs/as-path-body-select"
        },
        "as-path-in": {
          "$ref": "#/$defs/as-path-body-select"
        },
        "as4-path-eq": {
          "$ref": "#/$defs/as4-path-body-select"
        },
        "as4-path-in": {
          "$ref": "#/$defs/as4-path-body-select"
        },
        "community-eq": {
          "$ref": "#/$defs/community-body-select"
        },
        "community-in": {
          "$ref": "#/$defs/community-body-select"
        },
        "ext-community-eq": {
          "$ref": "#/$defs/ext-community-body-select"
        },
        "ext-community-in": {
          "$ref": "#/$defs/ext-community-body-select"
        },
        "large-community-eq": {
          "$ref": "#/$defs/large-community-body-select"
        },
        "large-community-in": {
          "$ref": "#/$defs/large-community-body-select"
        },
        "match-type": {
          "type": "string",
          "enum": [
            "ALL",
            "ANY"
          ],
          "default": "ALL"
        },
        "net-eq": {
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "prefix-v4": {
                  "$ref": "#/$defs/prefix-v4-type"
                }
              },
              "required": ["prefix-v4"],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "prefix-v6": {
                  "$ref": "#/$defs/prefix-v6-type"
                }
              },
              "required": ["prefix-v6"],
              "additionalProperties": false
            }
          ]
        },
        "net-in": {
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "prefix-v4": {
                  "$ref": "#/$defs/prefix-v4-type"
                }
              },
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "prefix-v6": {
                  "$ref": "#/$defs/prefix-v6-type"
                }
              },
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "prefix-v4-list": {
                  "$ref": "#/$defs/list-name-type"
                }
              },
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "prefix-v6-list": {
                  "$ref": "#/$defs/list-name-type"
                }
              },
              "additionalProperties": false
            }
          ]
        },
        "net-type-eq": {
          "$ref": "#/$defs/addr-family-type"
        },
        "source-protocol-eq": {
          "type": "string",
          "enum": [ "BGP", "STATIC" ]
        }
      },
      "additionalProperties": false
    },
    "net-body-select": {
      "oneOf": [
        {
          "type": "array",
          "items": {
              "$ref": "#/$defs/prefix-v4-type"
          },
          "required": ["prefix-v4"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "prefix-v4": {
              "$ref": "#/$defs/prefix-v4-type"
            }
          },
          "required": ["prefix-v4"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "prefix-v6": {
              "$ref": "#/$defs/prefix-v6-type"
            }
          },
          "required": ["prefix-v6"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "prefix-v4-list": {
              "$ref": "#/$defs/list-name-type"
            }
          },
          "required": ["prefix-v4-list"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "prefix-v6-list": {
              "$ref": "#/$defs/list-name-type"
            }
          },
          "required": ["prefix-v6-list"],
          "additionalProperties": false
        }
      ]
    },
    "large-community-body-select": {
      "oneOf": [
        {
          "$ref": "#/$defs/large-community-set-type"
        },
        {
          "type": "object",
          "properties": {
            "large-community-list": {
              "$ref": "#/$defs/list-name-type"
            }
          },
          "required": ["large-community-list"],
          "additionalProperties": false
        }
      ]
    },
    "list-name-type": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_]+$"
    }
  },
  "properties": {
    "router-id": {
      "type": "string",
      "pattern": "^(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])$"
    },
    "bgp": {
      "type": "object",
      "properties": {
        "as-path-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/as-path-type"
            }
          },
          "additionalProperties": false
        },
        "community-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/community-set-type"
            }
          },
          "additionalProperties": false
        },
        "ext-community-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/ext-community-set-type"
            }
          },
          "additionalProperties": false
        },
        "large-community-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/large-community-set-type"
            }
          },
          "additionalProperties": false
        },
        "policy-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "type": "object",
              "patternProperties": {
                "^term-[0-9]+$": {
                  "type": "object",
                  "properties": {
                    "seq": {
                      "type": "integer",
                      "minimum": 1
                    },
                    "if-match": {
                      "$ref": "#/$defs/if-match-body"
                    },
                    "then": {
                      "$ref": "#/$defs/action-body"
                    }
                  },
                  "required": [ "if-match", "then" ],
                  "additionalProperties": false
                },
                "default-action": {
                  "type": "string",
                  "enum": [ "deny", "permit" ],
                  "default": "deny"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "prefix-v4-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/prefix-v4-type"
            }
          },
          "additionalProperties": false
        },
        "prefix-v6-list": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "$ref": "#/$defs/prefix-v6-type"
            }
          },
          "additionalProperties": false
        },
        "sessions": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_]+$": {
              "type": "object",
              "properties": {
                "address-family": {
                  "$comment": "Channels name like: ipv4, ipv6, ipv4 multicast, ipv6 multicast, ipv4 mpls, ipv6 mpls, vpn4 mpls, vpn6 mpls, vpn4 multicast, vpn6 multicast, flow4, flow6",
                  "type": "object",
                  "patternProperties": {
                    "^ipv4|ipv6$": {
                      "type": "object",
                      "properties": {
                        "next-hop-self": {
                          "type": "boolean"
                        },
                        "policy-in": {
                          "$ref": "#/$defs/list-name-type"
                        },
                        "policy-out": {
                          "$ref": "#/$defs/list-name-type"
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                },
                "local": {
                  "type": "object",
                  "properties": {
                    "address": {
                      "oneOf": [
                        {
                          "type": "string",
                          "pattern": "^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9]))|(((([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])))(%[^\\s/]{1,15})?)$"
                        },
                        {
                          "type": "object",
                          "properties": {
                            "link-local": {
                              "type": "string",
                              "pattern": "^[^\\s/]{1,15}$"
                            }
                          },
                          "additionalProperties": false
                        }
                      ]
                    },
                    "as": {
                      "type": "integer",
                      "minimum": 1
                    },
                    "port": {
                      "type": "integer", "minimum": 0, "maximum": 65535
                    }
                  },
                  "additionalProperties": false,
                  "required": [ "as" ]
                },
                "peer": {
                  "type": "object",
                  "properties": {
                    "address": {
                      "oneOf": [
                        {
                          "type": "string",
                          "pattern": "^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9]))|(((([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])))(%[^\\s/]{1,15})?)$"
                        },
                        {
                          "type": "object",
                          "properties": {
                            "range": {
                              "type": "string",
                              "pattern": "^(((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])/([0-9]|[1-2][0-9]|3[0-2])))|((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,7}:|:(:[0-9A-Fa-f]{1,4}){1,7}|([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2}|([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3}|([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4}|([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5}|[0-9A-Fa-f]{1,4}:(:[0-9A-Fa-f]{1,4}){1,6}|:(:[0-9A-Fa-f]{1,4}){1,6})/([0-9]|[0-9][0-9]|1[0-1][0-9]|12[0-8]))$"
                            }
                          }
                        }
                      ]
                    },
                    "as": {
                      "oneOf": [
                        {
                          "type": "integer",
                          "minimum": 1
                        },
                        {
                          "type": "string",
                          "enum": [ "external", "internal" ]
                        }
                      ]
                    },
                    "port": {
                      "type": "integer", "minimum": 0, "maximum": 65535
                    }
                  },
                  "additionalProperties": false,
                  "required": [ "address", "as" ]
                }
              },
              "additionalProperties": false,
              "required": [ "address-family", "local", "peer" ]
            }
          },
          "additionalProperties": false
        }
      },
      "required": [ "sessions" ],
      "additionalProperties": false
    }
  },
  "additionalProperties": false,
  "required": [ "router-id" ]
}
